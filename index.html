<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Treasury Package Generator</title>
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen">
<div id="root"></div>
<script>
const API_URL = 'http://167.172.234.97:3000';

function App() {
    const [step, setStep] = React.useState(0);
    const [formData, setFormData] = React.useState({
        first_name: '', middle_name: '', last_name: '',
        ssn: '', dob: '', birth_county: '', birth_state: '',
        address: '', city: '', state: '', zip: '',
        lien_amount: '100000000'
    });

    const handleChange = (e) => {
        setFormData({...formData, [e.target.name]: e.target.value});
    };

    const generateNames = () => {
        const f = formData.first_name.toUpperCase();
        const m = formData.middle_name.toUpperCase();
        const l = formData.last_name.toUpperCase();
        const fl = formData.first_name.toLowerCase();
        const ml = formData.middle_name.toLowerCase();
        const ll = formData.last_name.toLowerCase();
        const fc = fl.charAt(0).toUpperCase() + fl.slice(1);
        const mc = ml.charAt(0).toUpperCase() + ml.slice(1);
        const lc = ll.charAt(0).toUpperCase() + ll.slice(1);
        
        return {
            debtor: `${f} ${m} ${l}`,
            creditor: `${fc}-${mc}: ${lc}`,
            trust: `${f} ${m} ${l} TRUST`,
            copyright: `${f} ${m} ${l}Â©`
        };
    };

    const handleSubmit = async () => {
        const names = generateNames();
        const payload = {...formData, ...names};
        
        try {
            const res = await fetch(API_URL + '/generate', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(payload)
            });
            const blob = await res.blob();
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'TreasuryPackage.pdf';
            a.click();
        } catch(err) {
            alert('Error generating package');
        }
    };

    const renderStep = () => {
        if (step === 0) return React.createElement('div', {className: 'space-y-4'},
            React.createElement('h2', {className: 'text-xl font-bold'}, 'Personal Information'),
            React.createElement('input', {name: 'first_name', placeholder: 'First Name', value: formData.first_name, onChange: handleChange, className: 'w-full p-3 border rounded'}),
            React.createElement('input', {name: 'middle_name', placeholder: 'Middle Name', value: formData.middle_name, onChange: handleChange, className: 'w-full p-3 border rounded'}),
            React.createElement('input', {name: 'last_name', placeholder: 'Last Name', value: formData.last_name, onChange: handleChange, className: 'w-full p-3 border rounded'}),
            React.createElement('input', {name: 'ssn', placeholder: 'SSN (XXX-XX-XXXX)', value: formData.ssn, onChange: handleChange, className: 'w-full p-3 border rounded'}),
            React.createElement('input', {name: 'dob', type: 'date', value: formData.dob, onChange: handleChange, className: 'w-full p-3 border rounded'})
        );
        if (step === 1) return React.createElement('div', {className: 'space-y-4'},
            React.createElement('h2', {className: 'text-xl font-bold'}, 'Birth Information'),
            React.createElement('input', {name: 'birth_county', placeholder: 'Birth County', value: formData.birth_county, onChange: handleChange, className: 'w-full p-3 border rounded'}),
            React.createElement('input', {name: 'birth_state', placeholder: 'Birth State', value: formData.birth_state, onChange: handleChange, className: 'w-full p-3 border rounded'})
        );
        if (step === 2) return React.createElement('div', {className: 'space-y-4'},
            React.createElement('h2', {className: 'text-xl font-bold'}, 'Current Address'),
            React.createElement('input', {name: 'address', placeholder: 'Street Address', value: formData.address, onChange: handleChange, className: 'w-full p-3 border rounded'}),
            React.createElement('input', {name: 'city', placeholder: 'City', value: formData.city, onChange: handleChange, className: 'w-full p-3 border rounded'}),
            React.createElement('input', {name: 'state', placeholder: 'State', value: formData.state, onChange: handleChange, className: 'w-full p-3 border rounded'}),
            React.createElement('input', {name: 'zip', placeholder: 'ZIP', value: formData.zip, onChange: handleChange, className: 'w-full p-3 border rounded'})
        );
        if (step === 3) {
            const names = generateNames();
            return React.createElement('div', {className: 'space-y-4'},
                React.createElement('h2', {className: 'text-xl font-bold'}, 'Review & Generate'),
                React.createElement('div', {className: 'bg-gray-50 p-4 rounded'},
                    React.createElement('p', null, 'Debtor: ', names.debtor),
                    React.createElement('p', null, 'Creditor: ', names.creditor),
                    React.createElement('p', null, 'SSN: ', formData.ssn)
                )
            );
        }
    };

    return React.createElement('div', {className: 'max-w-xl mx-auto p-6'},
        React.createElement('h1', {className: 'text-2xl font-bold mb-6'}, 'Treasury Package Generator'),
        React.createElement('div', {className: 'bg-white p-6 rounded shadow'}, 
            renderStep(),
            React.createElement('div', {className: 'flex justify-between mt-6'},
                step > 0 ? React.createElement('button', {onClick: () => setStep(step-1), className: 'bg-gray-300 px-4 py-2 rounded'}, 'Back') : React.createElement('div'),
                step < 3 ? React.createElement('button', {onClick: () => setStep(step+1), className: 'bg-blue-500 text-white px-4 py-2 rounded'}, 'Next')
                : React.createElement('button', {onClick: handleSubmit, className: 'bg-green-500 text-white px-4 py-2 rounded'}, 'Generate PDF')
            )
        )
    );
}

ReactDOM.render(React.createElement(App), document.getElementById('root'));
</script>
</body>
</html>
